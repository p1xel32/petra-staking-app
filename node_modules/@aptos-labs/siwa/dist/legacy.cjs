"use strict";var a=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var g=Object.getOwnPropertyNames;var m=Object.prototype.hasOwnProperty;var f=(e,s)=>{for(var i in s)a(e,i,{get:s[i],enumerable:!0})},l=(e,s,i,r)=>{if(s&&typeof s=="object"||typeof s=="function")for(let n of g(s))!m.call(e,n)&&n!==i&&a(e,n,{get:()=>s[n],enumerable:!(r=u(s,n))||r.enumerable});return e};var I=e=>l(a({},"__esModule",{value:!0}),e);var F={};f(F,{createLegacySignInMessage:()=>c,verifyLegacySignIn:()=>M});module.exports=I(F);var o=require("@aptos-labs/ts-sdk"),d=require("@noble/hashes/sha3");var p=require("@noble/hashes/sha3");function t(e){let s=`${e.domain} wants you to sign in with your Aptos account:
`;s+=`${e.address}`,e.statement&&(s+=`

${e.statement}`);let i=[];if(e.uri&&i.push(`URI: ${e.uri}`),e.version&&i.push(`Version: ${e.version}`),e.nonce&&i.push(`Nonce: ${e.nonce}`),e.issuedAt&&i.push(`Issued At: ${e.issuedAt}`),e.expirationTime&&i.push(`Expiration Time: ${e.expirationTime}`),e.notBefore&&i.push(`Not Before: ${e.notBefore}`),e.requestId&&i.push(`Request ID: ${e.requestId}`),e.chainId&&i.push(`Chain ID: ${e.chainId}`),e.resources){i.push("Resources:");for(let r of e.resources)i.push(`- ${r}`)}return i.length&&(s+=`

${i.join(`
`)}`),s}var h="(?<domain>[^\\n]+?) wants you to sign in with your Aptos account:\\n",_="(?<address>[^\\n]+)(?:\\n|$)",S="(?:\\n(?<statement>[\\S\\s]*?)(?:\\n|$))??",A="(?:\\nURI: (?<uri>[^\\n]+))?",y="(?:\\nVersion: (?<version>[^\\n]+))?",v="(?:\\nNonce: (?<nonce>[^\\n]+))?",R="(?:\\nIssued At: (?<issuedAt>[^\\n]+))?",E="(?:\\nExpiration Time: (?<expirationTime>[^\\n]+))?",x="(?:\\nNot Before: (?<notBefore>[^\\n]+))?",$="(?:\\nRequest ID: (?<requestId>[^\\n]+))?",T="(?:\\nChain ID: (?<chainId>[^\\n]+))?",V="(?:\\nResources:(?<resources>(?:\\n- [^\\n]+)*))?",q=`${A}${y}${v}${R}${E}${x}${$}${T}${V}`,b=new RegExp(`^${h}${_}${S}${q}\\n*$`);var c=e=>{let s=t(e);return s+=`

Hash: ${o.Hex.fromHexInput((0,d.sha3_256)(s)).toString()}`,s},M=(e,s)=>{let i=c(e);return s.message.includes(i)?s.publicKey.verifySignature(s)?{valid:!0,data:e}:{valid:!1,errors:["invalid_signature"]}:{valid:!1,errors:["invalid_full_message"]}};0&&(module.exports={createLegacySignInMessage,verifyLegacySignIn});
//# sourceMappingURL=legacy.cjs.map